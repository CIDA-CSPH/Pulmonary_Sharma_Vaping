<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Trent Hawkins">

<title>Comb-p For Dummies</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="combp_for_dummies_files/libs/clipboard/clipboard.min.js"></script>
<script src="combp_for_dummies_files/libs/quarto-html/quarto.js"></script>
<script src="combp_for_dummies_files/libs/quarto-html/popper.min.js"></script>
<script src="combp_for_dummies_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="combp_for_dummies_files/libs/quarto-html/anchor.min.js"></script>
<link href="combp_for_dummies_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="combp_for_dummies_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="combp_for_dummies_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="combp_for_dummies_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="combp_for_dummies_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Comb-p For Dummies</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Trent Hawkins </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="motivation" class="level2">
<h2 class="anchored" data-anchor-id="motivation">Motivation</h2>
<p>When working on a Methylation project in 2023, I was nearing the end and it was time to run a Differentially Methylated Region (DMR) analysis. A common method to carry out DMR analyses is known as combined-pvalues (comb-p), and the most popular tool for implementing this method is a command-line tool that allows the user to run a series of python code files by executing one line of code. As a novice in python, I was completely overwhelmed with the vast array of options for installing and running this tool. Furthermore, the software is over a decade old, sometimes relying on outdated packages and the documentation is not completely thorough. For python pros, this document will be completely overkill. Its purpose is to document one way that I was able to get the comb-p pipeline involved after much pain and suffering. Don’t be scared! It’s really straight-forward in the end.</p>
<p>Please note that that the mechanisms behind the inter-workings of comb-p are outside of the scope of this document. For more information, please reference <a href="https://github.com/brentp/combined-pvalues/">github</a> for comb-p.</p>
</section>
<section id="installing-conda" class="level2">
<h2 class="anchored" data-anchor-id="installing-conda">Installing Conda</h2>
<p>For those who are not familiar with Python, if you go straight to the comb-p website, and start trying to install comb-p to run from the command line, you have already skipped ahead to the end of this tutorial.</p>
<p>Long story short, Conda is a wonderful virtual environment and package manager for Python that will make your life so much easier. When you download the full distribution of Anaconda, it will download conda (the command-line tool for package and environment management), Anaconda-Navigator (their proprietary GUI for managing packages and environments), and the latest version of Python. Full instructions are available <a href="https://docs.anaconda.com/anaconda/install/index.html">here</a> for whatever computing environment you might be working in with video instructions. I would recommend following them.</p>
</section>
<section id="setting-up-a-conda-virtual-environment" class="level2">
<h2 class="anchored" data-anchor-id="setting-up-a-conda-virtual-environment">Setting up a Conda Virtual Environment</h2>
<p>It is of utmost importance that you create a <strong>clean</strong> virtual environment especially for running comb-p, and it will need to be running Python 2.7 in order to be compatible with comb-p and its dependencies. If you don’t use a clean environment, conda will likely struggle to download comb-p due to all of the package conflicts it will be trying to manage. You can do so by executing the command below in your terminal:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create Conda Environment for Comb-p</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> create <span class="at">--name</span> CombpEnv python=2.7</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Activate Conda Environment</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> activate CombpEnv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Great! Now you have created your virtual environment, which is running Python 2.7.x, and activated it. You should see the name of your active environment on the left side of your terminal.</p>
</section>
<section id="setting-up-the-bioconda-channel" class="level2">
<h2 class="anchored" data-anchor-id="setting-up-the-bioconda-channel">Setting up the BioConda channel</h2>
<p>BioConda is the channel (place that hosts python libraries) that hosts most bioinformatics tools available for Python. We will be using it in order to install Comb-p.&nbsp;As per the setup guidelines available <a href="https://bioconda.github.io/">here</a>, run the following code to configure the BioConda channel.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> config <span class="at">--add</span> channels defaults</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> config <span class="at">--add</span> channels bioconda</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> config <span class="at">--add</span> channels conda-forge</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> config <span class="at">--set</span> channel_priority strict</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Once you have configured the Bioconda Channel, you can ensure that the channels are configured properly by running the following:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> config <span class="at">--show</span> channels</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>channels:
  - conda-forge
  - bioconda
  - defaults</code></pre>
</div>
</div>
<p>If your output matches the output above, you have successfully configured BioConda.</p>
</section>
<section id="installation-bedtools-and-comb-p" class="level2">
<h2 class="anchored" data-anchor-id="installation-bedtools-and-comb-p">Installation (Bedtools and Comb-p)</h2>
<p>In this section, we will install the following libraries and dependencies in order to create the sorted .bed files and run the comb-p pipeline with annotation capabilities:</p>
<ol type="1">
<li>bedtools</li>
<li>combined-pvalues (comb-p)</li>
<li>cruzdb (annotation)</li>
</ol>
<p>Bedtools and Comb-p can both be installed via the BioConda channel that we already configured.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install bedtools</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install combined-pvalues</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>cruzdb is not hosted on BioConda, but can be installed from PyPi using the <code>pip</code> command.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install cruzdb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>We will also need to install some of the dependencies of this package, which do not install automatically for whatever reason.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Just going to install all the packages in one line</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install sqlalchemy six MySQL-python</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>If all of these installations worked, CONGRATULATIONS! You are finally ready to run the comb-p pipeline!</p>
</section>
<section id="accessing-illumina-annotation-and-creating-your-first-.bed-file" class="level2">
<h2 class="anchored" data-anchor-id="accessing-illumina-annotation-and-creating-your-first-.bed-file">Accessing Illumina annotation and creating your first <code>.bed</code> file</h2>
<p>A <code>.bed</code> file is a specific format of plain-text file that defines genetic sequence features to a genetic sequence. What makes a <code>.bed</code> file a <code>.bed</code> file instead of a <code>.txt</code> file is that the first three columns correspond to:</p>
<ol type="1">
<li><p>Chromosome Name</p>
<ul>
<li>Chromosome 1, 2, …, 22, X, Y</li>
</ul></li>
<li><p>Chromosome Start</p>
<ul>
<li>Position of the first base of the feature sequence. In a DMR, this will come from the field ‘pos’ in the Illumina annotation and refers to the base where the probe is binded.</li>
</ul></li>
<li><p>Chromosome End</p>
<ul>
<li>Position of the last base of the feature sequence. In a DMR, this can be created as the number from ‘pos’ + 51.</li>
</ul></li>
</ol>
<p>In the case of DMR analysis, there will also be a 4th column which corresponds to <strong>unadjusted</strong> p-values from the EWAS which should have been completed before this point.</p>
<p>Next, we will need to access annotation data. I will do this part in R, but I am sure there are other ways to access annotation. To access Illumina’s annotation, you can use the <code>getAnnotation</code> from the package <em>minfi</em>, which can be downloaded from BioConductor. You will likely have already needed this package and function before this point. I will use the Illumina EPIC annotation in this example becuase that is what I used for the related project.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the packages we will need</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(tidyverse)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(minfi)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(IlluminaHumanMethylationEPICanno.ilm10b4.hg19) <span class="co">#Annotation</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(data.table) <span class="co">#Read and write large files</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Load in the results from your EWAS (I won't do this part)</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#EWAS_res &lt;- read_csv("path/to/your/data")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Ok, now that we have everything loaded in, we can get the data we need from the annotation data. As I mentioned previously, we will only need ‘Name’, “chrom”, and “pos” here.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Get Annotation</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>annotation.table <span class="ot">&lt;-</span> <span class="fu">getAnnotation</span>(IlluminaHumanMethylationEPICanno.ilm10b4.hg19)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Pull out the columns you need</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>mapping <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"Name"</span> <span class="ot">=</span> annotation.table<span class="sc">$</span>Name,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"chrom"</span> <span class="ot">=</span> annotation.table<span class="sc">$</span>chr,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"pos"</span> <span class="ot">=</span> annotation.table<span class="sc">$</span>pos)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(mapping)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 865859      3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mapping)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Name chrom       pos
1 cg18478105 chr20  61847650
2 cg09835024  chrX  24072640
3 cg14361672  chr9 131463936
4 cg01763666 chr17  80159506
5 cg12950382 chr14 105176736
6 cg02115394 chr13 115000168</code></pre>
</div>
</div>
<p>Ok, so now the object <code>mapping</code> should have all 850,000+ probes from the Illumina annotation, along with which chromosome they appear on, and what position they bind to. We only need the probes that we tested in our EWAS. We can accomplish that using a <code>left_join</code>. We will then format the data so that we can write it out as a <code>.bed</code> file.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>bed <span class="ot">&lt;-</span> <span class="fu">left_join</span>(EWAS_res, mapping, <span class="at">by =</span> <span class="st">"Name"</span>) </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>bed_for_combp <span class="ot">&lt;-</span> bed <span class="sc">%&gt;%</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">start =</span> pos,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">end =</span> pos <span class="sc">+</span> <span class="dv">51</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(chrom, start, end, pval)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>The resulting table should look something like this:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  chrom     start       end          p
1 chr20  61847650  61847701 0.26134938
2  chrX  24072640  24072691 0.09058153
3  chr9 131463936 131463987 0.31954781
4 chr17  80159506  80159557 0.32398807
5 chr14 105176736 105176787 0.05410278
6 chr13 115000168 115000219 0.56302766</code></pre>
</div>
</div>
<p>It is ok if you have not sorted on any particular column yet. That will be the next step. If your table looks like this, then we can write it out as a <code>.bed</code> file using the following:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data.table<span class="sc">::</span><span class="fu">fwrite</span>(bed_for_combp, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"path/to/your/file.bed"</span>),</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">row.names =</span> F,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">col.names =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Awesome! You have written out your <code>.bed</code> file. Time to go back to the command line.</p>
</section>
<section id="creating-a-sorted-.bed-file" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-sorted-.bed-file">Creating a sorted <code>.bed</code> file</h2>
<p>Great now it is time to create a sorted <code>.bed</code> file, attach the appropriate column names back in, and run comb-p! Ideally, you should have your <code>.bed</code> file stored in its own folder because the following steps will create quite a few files.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Go to the folder where your .bed file is stored</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> path/to/your/folder</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Run sort from bedtools</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="ex">sortBed</span> <span class="at">-i</span> input.bed <span class="op">&gt;</span> sorted.bed</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Attach the proper column names</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-e</span> <span class="st">"chrom\tstart\tend\trawp"</span> <span class="kw">|</span> <span class="fu">cat</span> <span class="at">-</span> sorted.bed <span class="op">&gt;</span> sorted_for_combp.bed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Great! You have created your file which is ready to go! Time for the grand finale!</p>
</section>
<section id="running-comb-p" class="level2">
<h2 class="anchored" data-anchor-id="running-comb-p">Running Comb-p</h2>
<p>Now it is time to run comb-p.&nbsp;This step may take some patience. If you follow the instructions as I have outlined them here, everything <em>should</em> run smoothly. Please note that some of the settings below are customizable and context-specific. Please make sure you understand the various settings before running this code. Assuming you are still in the same directory in your terminal:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">comb-p</span> pipeline <span class="at">-c</span> 4 <span class="at">--seed</span> 0.1 <span class="at">--dist</span> 750 <span class="at">-p</span> combp_res.bed <span class="at">--anno</span> hg19 sorted_for_combp.bed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>You’re done! The results file will be something like “combp_res.bed.anno.hg19.bed” and you can read it back in like you would any tab-delimmited file and manipulate it to your liking.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>